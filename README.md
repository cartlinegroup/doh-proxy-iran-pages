# ğŸ›¡ï¸ Ultimate Iran Proxy - Pages

Ú©Ø§Ù…Ù„â€ŒØªØ±ÛŒÙ† Ø³ÛŒØ³ØªÙ… Ø¯Ø³ØªØ±Ø³ÛŒ Ø¢Ø²Ø§Ø¯ Ø¨Ù‡ Ø§ÛŒÙ†ØªØ±Ù†Øª Ø¨Ø§ Cloudflare Pages Functions

## ğŸ“‹ ÙÙ‡Ø±Ø³Øª Ù…Ø·Ø§Ù„Ø¨

- [ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§](#ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§)
- [Ù†ØµØ¨ Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ](#Ù†ØµØ¨-Ùˆ-Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ)  
- [ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ø±ÙˆØ±Ú¯Ø±](#ØªÙ†Ø¸ÛŒÙ…Ø§Øª-Ù…Ø±ÙˆØ±Ú¯Ø±)
- [API Ù…Ø³ØªÙ†Ø¯Ø§Øª](#api-Ù…Ø³ØªÙ†Ø¯Ø§Øª)
- [Ø¹Ù…Ù„Ú©Ø±Ø¯ Ùˆ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ](#Ø¹Ù…Ù„Ú©Ø±Ø¯-Ùˆ-Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ)
- [Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ](#Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ)

## ğŸš€ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§

### Smart DNS Intelligence
- ØªØ´Ø®ÛŒØµ Ø®ÙˆØ¯Ú©Ø§Ø± Ù†ÙˆØ¹ Ø³Ø§ÛŒØª (Ø§ÛŒØ±Ø§Ù†ÛŒØŒ Ù…Ø³Ø¯ÙˆØ¯ØŒ gamingØŒ Ø¨ÛŒÙ†â€ŒØ§Ù„Ù…Ù„Ù„ÛŒ)
- Ù…Ø³ÛŒØ±ÛŒØ§Ø¨ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ø­ØªÙˆØ§
- Ú©Ø´ Ø¨Ù‡ÛŒÙ†Ù‡ Ø¨Ø§ TTL Ù…ØªØºÛŒØ±
- Fallback Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ù‡ DNS providers Ø¯ÛŒÚ¯Ø±

### Geographic Routing  
- Ù…Ø³ÛŒØ±ÛŒØ§Ø¨ÛŒ Ø§Ø² Ø·Ø±ÛŒÙ‚ 10 edge location Ø¬Ù‡Ø§Ù†ÛŒ Cloudflare
- Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ ECS Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ù…Ù†Ø·Ù‚Ù‡
- Ø³Ø§ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø§ÛŒØ±Ø§Ù†ÛŒ: Ù…Ø³ÛŒØ± Ù…Ø³ØªÙ‚ÛŒÙ…
- Ø³Ø§ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…Ø³Ø¯ÙˆØ¯: Ø¹Ø¨ÙˆØ± Ø§Ø² edge Ø®Ø§Ø±Ø¬ÛŒ

### Gaming Optimization
- Ú©Ø§Ù‡Ø´ ping ØªØ§ 50ms Ø¨Ø±Ø§ÛŒ gaming
- Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ±ÛŒÙ† game servers
- Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² SteamØŒ Riot GamesØŒ Epic Games
- Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ real-time Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø§ÛŒØ±Ø§Ù†ÛŒ

### HTTP Proxy
- Ø¯Ø³ØªØ±Ø³ÛŒ Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ Ø³Ø§ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…Ø³Ø¯ÙˆØ¯
- Ø±Ø§Ø¨Ø· Ù…Ø±ÙˆØ±Ú¯Ø± ÙˆØ¨ Ú©Ø§Ù…Ù„
- Ø§ØµÙ„Ø§Ø­ Ø®ÙˆØ¯Ú©Ø§Ø± HTML/CSS/JS
- Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² mobile Ùˆ desktop

### Browser Compatibility
- DNS Wire Format Ú©Ø§Ù…Ù„
- JSON API Ø³Ø§Ø²Ú¯Ø§Ø± Ø¨Ø§ RFC 8484
- Base64 encoded queries
- Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² ØªÙ…Ø§Ù… DoH clients

## ğŸ“ Ø³Ø§Ø®ØªØ§Ø± Ù¾Ø±ÙˆÚ˜Ù‡

```
doh-proxy-iran-pages/
â”œâ”€â”€ functions/
â”‚   â””â”€â”€ _middleware.js    # Ú©Ø¯ Ø§ØµÙ„ÛŒ Pages Functions
â”œâ”€â”€ index.html           # ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ
â”œâ”€â”€ browse.html          # Web Browser Interface
â””â”€â”€ README.md            # Ø§ÛŒÙ† ÙØ§ÛŒÙ„
```

## âš™ï¸ Ù†ØµØ¨ Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ

### 1. Fork Repository
```bash
# Ú©Ù„ÙˆÙ† repository
git clone https://github.com/feizezadeh/doh-proxy-iran-pages.git
cd doh-proxy-iran-pages
```

### 2. Deploy Ø¯Ø± Cloudflare Pages
1. ÙˆØ§Ø±Ø¯ [Cloudflare Dashboard](https://dash.cloudflare.com) Ø´ÙˆÛŒØ¯
2. **Workers & Pages** â†’ **Create Application** â†’ **Pages**
3. **Connect to Git** â†’ Ø§Ù†ØªØ®Ø§Ø¨ repository
4. ØªÙ†Ø¸ÛŒÙ…Ø§Øª Build:
   - Build command: (Ø®Ø§Ù„ÛŒ)
   - Build output directory: `/`
   - Root directory: `/`
5. **Save and Deploy**

### 3. Domain Ø³ÙØ§Ø±Ø´ÛŒ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
- **Custom domains** â†’ **Set up a custom domain**
- DNS record Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯: `CNAME your-domain.com your-project.pages.dev`

## ğŸ”§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ø±ÙˆØ±Ú¯Ø±

### Firefox
```
1. about:config
2. network.trr.mode = 2
3. network.trr.uri = https://your-domain.pages.dev/dns-query
4. Restart Firefox
```

### Chrome/Edge
```
1. Settings â†’ Privacy and Security â†’ Security
2. Use secure DNS â†’ Custom
3. https://your-domain.pages.dev/dns-query
4. Restart Browser
```

### Android

#### Ø±ÙˆØ´ 1: Intra App
```
1. Ù†ØµØ¨ Intra Ø§Ø² Google Play Store
2. Custom DNS over HTTPS
3. https://your-domain.pages.dev/dns-query
4. Turn On
```

#### Ø±ÙˆØ´ 2: 1.1.1.1 App
```
1. Ù†ØµØ¨ 1.1.1.1 Ø§Ø² Google Play Store  
2. Advanced â†’ Connection options â†’ DNS over HTTPS
3. Custom â†’ https://your-domain.pages.dev/dns-query
```

### iOS
```
1. Ù†ØµØ¨ DNSCloak ÛŒØ§ 1.1.1.1
2. DNS over HTTPS
3. https://your-domain.pages.dev/dns-query
```

## ğŸ“š API Ù…Ø³ØªÙ†Ø¯Ø§Øª

### Base URL
```
https://your-domain.pages.dev
```

### DNS Query API

#### Basic Query
```http
GET /dns-query?name=example.com&type=A
```

#### Ø¨Ø§ Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø§Ø¶Ø§ÙÛŒ
```http
GET /dns-query?name=steam.com&type=A&gaming=true
GET /dns-query?name=twitter.com&type=A&geo=abroad
GET /dns-query?name=site.com&format=simple
```

#### Wire Format (POST)
```http
POST /dns-query
Content-Type: application/dns-message
Accept: application/dns-message

[DNS wire format data]
```

### HTTP Proxy API

#### Basic Proxy
```http
GET /proxy?url=https://github.com
```

#### Direct URL
```http
GET /p/https://twitter.com
```

### System APIs

#### Status Check  
```http
GET /status
```

#### Geographic Info
```http
GET /geo-status
```

#### Speed Test
```http
GET /speed-test
```

#### Gaming Servers
```http
GET /game-servers?game=steam
```

#### Ping Test
```http
GET /ping-test?target=google.com
```

#### Configuration
```http
GET /config
```

## ğŸ¯ Ù†Ù…ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø¯ÛŒ

### DNS Queries
```bash
# ØªØ³Øª basic
curl "https://your-domain.pages.dev/dns-query?name=google.com"

# gaming mode
curl "https://your-domain.pages.dev/dns-query?name=steampowered.com&gaming=true"

# forced geographic routing
curl "https://your-domain.pages.dev/dns-query?name=twitter.com&geo=abroad"
```

### HTTP Proxy
```bash
# Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ GitHub
curl "https://your-domain.pages.dev/proxy?url=https://github.com"

# Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Twitter
curl "https://your-domain.pages.dev/p/https://twitter.com"
```

### System Status
```bash
# ÙˆØ¶Ø¹ÛŒØª Ø³ÛŒØ³ØªÙ…
curl "https://your-domain.pages.dev/status"

# Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¬ØºØ±Ø§ÙÛŒØ§ÛŒÛŒ
curl "https://your-domain.pages.dev/geo-status"
```

## ğŸ“Š Ø¹Ù…Ù„Ú©Ø±Ø¯ Ùˆ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ

### Ø¢Ù…Ø§Ø± Ø¹Ù…Ù„Ú©Ø±Ø¯
- **DNS Latency**: 2-50ms Ù…Ø¹Ù…ÙˆÙ„ÛŒ
- **Proxy Overhead**: 10-30ms Ø§Ø¶Ø§ÙÛŒ
- **Gaming Improvement**: 15-50ms Ú©Ø§Ù‡Ø´ ping
- **Cache Hit Ratio**: 80-95% Ù…Ø¹Ù…ÙˆÙ„ÛŒ
- **Uptime Target**: 99.9%

### Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒâ€ŒÙ‡Ø§
- ECS-based geographic optimization
- Intelligent TTL Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†ÙˆØ¹ Ù…Ø­ØªÙˆØ§
- Multi-provider DNS fallback
- Cloudflare edge caching
- Smart routing algorithms

### Ù…Ø­Ø¯ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§
- Cloudflare Pages: 100,000 requests/day (Ø±Ø§ÛŒÚ¯Ø§Ù†)
- Function execution: 10ms CPU time/request
- Memory: 128MB per function
- Response size: 25MB maximum

## ğŸ› ï¸ ØªÙˆØ³Ø¹Ù‡ Ùˆ Ø³ÙØ§Ø±Ø´ÛŒâ€ŒØ³Ø§Ø²ÛŒ

### Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø³Ø§ÛŒØª Ø¬Ø¯ÛŒØ¯

#### Ø³Ø§ÛŒØª Ù…Ø³Ø¯ÙˆØ¯
```javascript
// Ø¯Ø± functions/_middleware.js
const BLOCKED_SITES = [
  // ... Ø³Ø§ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯
  'new-blocked-site.com'
]
```

#### Ø³Ø§ÛŒØª Ø§ÛŒØ±Ø§Ù†ÛŒ
```javascript
const IRANIAN_SITES = [
  // ... Ø³Ø§ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯  
  'new-iranian-site.ir'
]
```

#### Ø¯Ø§Ù…Ù†Ù‡ Gaming
```javascript
const GAMING_DOMAINS = [
  // ... Ø¯Ø§Ù…Ù†Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯
  'new-game-platform.com'
]
```

### ØªÙ†Ø¸ÛŒÙ… Gaming Servers
```javascript
const GAMING_SERVERS = {
  'new-platform': {
    regions: [
      { 
        name: 'Dubai', 
        ip: '1.2.3.4', 
        ping_estimate: 40, 
        best_for_iran: true 
      }
    ]
  }
}
```

### ØªØºÛŒÛŒØ± Edge Locations
```javascript
const NON_IRAN_EDGES = [
  'DXB', 'IST', 'FRA', // ... edge locations
  'NEW'  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† edge Ø¬Ø¯ÛŒØ¯
]
```

## ğŸ” Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ

### Ù…Ø´Ú©Ù„Ø§Øª Ù…ØªØ¯Ø§ÙˆÙ„

#### DNS Ú©Ø§Ø± Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯
```bash
# ØªØ³Øª manual
curl "https://your-domain.pages.dev/dns-query?name=google.com"

# Ø¨Ø±Ø±Ø³ÛŒ status
curl "https://your-domain.pages.dev/status"
```

#### Proxy Ø®Ø·Ø§ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯
- Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯ URL Ù…Ø¬Ø§Ø² Ø¨Ø§Ø´Ø¯
- ÙÙ‚Ø· Ø³Ø§ÛŒØªâ€ŒÙ‡Ø§ÛŒ HTTPS Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
- Ø¨Ø±Ø®ÛŒ Ø³Ø§ÛŒØªâ€ŒÙ‡Ø§ frame blocking Ø¯Ø§Ø±Ù†Ø¯

#### Ø¹Ù…Ù„Ú©Ø±Ø¯ Ú©Ù†Ø¯
- Ú©Ø´ Ù…Ø±ÙˆØ±Ú¯Ø± Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯
- Ø§Ø² mode Ø®ØµÙˆØµÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
- ØªØ³Øª Ú©Ù†ÛŒØ¯: `/speed-test`

### Debug Mode
```javascript
// Ø¯Ø± console Ù…Ø±ÙˆØ±Ú¯Ø±
console.log('Ultimate Proxy Debug Mode');

// ØªØ³Øª DNS
fetch('/dns-query?name=google.com')
  .then(r => r.json())
  .then(console.log);

// ØªØ³Øª Geo Status  
fetch('/geo-status')
  .then(r => r.json())
  .then(console.log);
```

## ğŸ“ˆ Ù…Ø§Ù†ÛŒØªÙˆØ±ÛŒÙ†Ú¯

### Cloudflare Analytics
- **Workers & Pages** â†’ **Analytics**
- Ù†Ù…Ø§ÛŒØ´ requestsØŒ errorsØŒ latency
- Usage patterns Ùˆ geographic data

### Custom Monitoring
```bash
# Status check script
#!/bin/bash
response=$(curl -s "https://your-domain.pages.dev/status")
if [[ $response == *"operational"* ]]; then
    echo "âœ… System OK"
else
    echo "âŒ System Down"
fi
```

## ğŸ” Ø§Ù…Ù†ÛŒØª

### Best Practices
- Ù‡Ù…ÛŒØ´Ù‡ Ø§Ø² HTTPS Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
- Browser cache Ù…Ù†Ø¸Ù… Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯
- Ø§Ø² DNS leak test Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
- ØªØ±Ø§ÙÛŒÚ© Ø®ÙˆØ¯ Ø±Ø§ monitor Ú©Ù†ÛŒØ¯

### Privacy
- No logging policy
- ØªÙ…Ø§Ù… traffic Ø±Ù…Ø²Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù‡
- Geographic routing Ø¨Ø±Ø§ÛŒ privacy
- Open source Ùˆ Ù‚Ø§Ø¨Ù„ Ø¨Ø±Ø±Ø³ÛŒ

## ğŸ¤ Ù…Ø´Ø§Ø±Ú©Øª

### Issues
- Bug reports Ø¯Ø± GitHub Issues
- Feature requests Ø®ÙˆØ´Ø¢Ù…Ø¯
- Security issues: Ø§ÛŒÙ…ÛŒÙ„ Ù…Ø³ØªÙ‚ÛŒÙ…

### Pull Requests
1. Fork repository
2. Ø§ÛŒØ¬Ø§Ø¯ feature branch
3. Commit Ø¨Ø§ Ù¾ÛŒØ§Ù… ÙˆØ§Ø¶Ø­
4. Ø§ÛŒØ¬Ø§Ø¯ Pull Request

### Development Setup
```bash
# Clone
git clone https://github.com/feizezadeh/doh-proxy-iran-pages.git

# Local development
npx wrangler pages dev

# Testing
curl "http://localhost:8788/dns-query?name=google.com"
```

## ğŸ“„ Ù„ÛŒØ³Ù†Ø³

MIT License - Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¢Ø²Ø§Ø¯ Ø¨Ø±Ø§ÛŒ ØªÙ…Ø§Ù… Ø§Ù‡Ø¯Ø§Ù

## ğŸ”— Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ù…ÙÛŒØ¯

- [Cloudflare Pages Docs](https://developers.cloudflare.com/pages/)
- [DNS over HTTPS RFC](https://tools.ietf.org/html/rfc8484)
- [Cloudflare Workers Docs](https://developers.cloudflare.com/workers/)

## ğŸ“ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ

- **GitHub Issues**: Ø¨Ø±Ø§ÛŒ bugs Ùˆ feature requests
- **Documentation**: Ø§ÛŒÙ† README Ùˆ comments Ø¯Ø± Ú©Ø¯
- **Community**: GitHub Discussions

---

**Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ Ø¨Ø§ â¤ï¸ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø§ÛŒØ±Ø§Ù†ÛŒ**

*Ultimate Iran Proxy - Ø¯Ø³ØªØ±Ø³ÛŒ Ø¢Ø²Ø§Ø¯ØŒ Ø§Ù…Ù† Ùˆ Ø³Ø±ÛŒØ¹ Ø¨Ù‡ Ø§ÛŒÙ†ØªØ±Ù†Øª Ø¬Ù‡Ø§Ù†ÛŒ*